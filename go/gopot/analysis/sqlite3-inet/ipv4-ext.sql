.load './libsqliteipv4.so'

select 'ERROR IP2INT(''192.168.1.1'')' where IP2INT('192.168.1.1') IS NULL OR IP2INT('192.168.1.1')!=3232235777;
select 'ERROR IP2INT(''255.255.255.255'')' where IP2INT('255.255.255.255') IS NULL OR IP2INT('255.255.255.255')!=4294967295;
select 'ERROR IP2INT(''0.0.0.0'')' where IP2INT('0.0.0.0') IS NULL OR IP2INT('0.0.0.0')!=0;

select 'ERROR INT2IP(''3232235777'')' where INT2IP('3232235777') IS NULL OR INT2IP('3232235777')!='192.168.1.1';
select 'ERROR INT2IP(''4294967295'')' where INT2IP('4294967295') iS NULL OR INT2IP('4294967295')!='255.255.255.255';
select 'ERROR INT2IP(''0'')' where INT2IP('0') IS NULL OR INT2IP('0')!='0.0.0.0';

select 'ERROR NETFROM(''192.168.1.1/255.255.255.0'')' where NETFROM('192.168.1.1/255.255.255.0') IS NULL OR NETFROM('192.168.1.1/255.255.255.0')!=3232235776;
select 'ERROR NETFROM(''192.168.1.1/24'')' where NETFROM('192.168.1.1/24') IS NULL OR NETFROM('192.168.1.1/24')!=3232235776;
select 'ERROR NETFROM(''192.168.1.1'',''255.255.255.0'')' where NETFROM('192.168.1.1','255.255.255.0') IS NULL OR NETFROM('192.168.1.1','255.255.255.0')!=3232235776;
select 'ERROR NETFROM(''192.168.1.1'',''24'')' where NETFROM('192.168.1.1','24') IS NOT NULL;
select 'ERROR NETFROM(''192.168.1.1'',24)' where NETFROM('192.168.1.1',24) IS NULL OR NETFROM('192.168.1.1',24)!=3232235776;

select 'ERROR NETFROM(''192.168.1.1/255.255.255.255'')' where NETFROM('192.168.1.1/255.255.255.255') IS NULL OR NETFROM('192.168.1.1/255.255.255.255')!=3232235777;
select 'ERROR NETFROM(''192.168.1.1/32'')' where NETFROM('192.168.1.1/32') IS NULL OR NETFROM('192.168.1.1/32')!=3232235777;
select 'ERROR NETFROM(''192.168.1.1'',''255.255.255.255'')' where NETFROM('192.168.1.1','255.255.255.255') IS NULL OR NETFROM('192.168.1.1','255.255.255.255')!=3232235777;
select 'ERROR NETFROM(''192.168.1.1'',''32'')' where NETFROM('192.168.1.1','32') IS NOT NULL;
select 'ERROR NETFROM(''192.168.1.1'',32)' where NETFROM('192.168.1.1',32) IS NULL OR NETFROM('192.168.1.1',32)!=3232235777;

select 'ERROR NETFROM(''192.168.1.1/255.255.128.0'')' where NETFROM('192.168.1.1/255.255.128.0') IS NULL OR NETFROM('192.168.1.1/255.255.128.0')!=3232235520;
select 'ERROR NETFROM(''192.168.1.1/17'')' where NETFROM('192.168.1.1/17') IS NULL OR NETFROM('192.168.1.1/17')!=3232235520;
select 'ERROR NETFROM(''192.168.1.1'',''255.255.128.0'')' where NETFROM('192.168.1.1','255.255.128.0') IS NULL OR NETFROM('192.168.1.1','255.255.128.0')!=3232235520;
select 'ERROR NETFROM(''192.168.1.1'',''17'')' where NETFROM('192.168.1.1','17') IS NOT NULL;
select 'ERROR NETFROM(''192.168.1.1'',17)' where NETFROM('192.168.1.1',17) IS NULL OR NETFROM('192.168.1.1',17)!=3232235520;

select 'ERROR NETLENGTH(''192.168.1.1'',''255.255.255.0'')' where NETLENGTH('192.168.1.1','255.255.255.0') IS NULL OR NETLENGTH('192.168.1.1','255.255.255.0')!=256;
select 'ERROR NETLENGTH(''192.168.1.1'',''24'')' where NETLENGTH('192.168.1.1','24') IS NOT NULL;
select 'ERROR NETLENGTH(''192.168.1.1'',24)' where NETLENGTH('192.168.1.1',24) IS NULL OR NETLENGTH('192.168.1.1',24)!=256;
select 'ERROR NETLENGTH(''192.168.1.1/255.255.255.0'')' where NETLENGTH('192.168.1.1/255.255.255.0') IS NULL OR NETLENGTH('192.168.1.1/255.255.255.0')!=256;
select 'ERROR NETLENGTH(''192.168.1.1/24'')' where NETLENGTH('192.168.1.1/24') IS NULL OR NETLENGTH('192.168.1.1/24')!=256;

select 'ERROR NETLENGTH(''192.168.1.1'',''255.255.255.255'')' where NETLENGTH('192.168.1.1','255.255.255.255') IS NULL OR NETLENGTH('192.168.1.1','255.255.255.255')!=1;
select 'ERROR NETLENGTH(''192.168.1.1'',''32'')' where NETLENGTH('192.168.1.1','32') IS NOT NULL;
select 'ERROR NETLENGTH(''192.168.1.1'',32)' where NETLENGTH('192.168.1.1',32) IS NULL OR NETLENGTH('192.168.1.1',32)!=1;
select 'ERROR NETLENGTH(''192.168.1.1/255.255.255.255'')' where NETLENGTH('192.168.1.1/255.255.255.255') IS NULL OR NETLENGTH('192.168.1.1/255.255.255.255')!=1;
select 'ERROR NETLENGTH(''192.168.1.1/32'')' where NETLENGTH('192.168.1.1/32') IS NULL OR NETLENGTH('192.168.1.1/32')!=1;

select 'ERROR NETLENGTH(''192.168.1.1'',''255.255.128.0'')' where NETLENGTH('192.168.1.1','255.255.128.0') IS NULL OR NETLENGTH('192.168.1.1','255.255.128.0')!=32768;
select 'ERROR NETLENGTH(''192.168.1.1'',''17'')' where NETLENGTH('192.168.1.1','17') IS NOT NULL;
select 'ERROR NETLENGTH(''192.168.1.1'',17)' where NETLENGTH('192.168.1.1',17) IS NULL OR NETLENGTH('192.168.1.1',17)!=32768;
select 'ERROR NETLENGTH(''192.168.1.1/255.255.128.0'')' where NETLENGTH('192.168.1.1/255.255.128.0') IS NULL OR NETLENGTH('192.168.1.1/255.255.128.0')!=32768;
select 'ERROR NETLENGTH(''192.168.1.1/17'')' where NETLENGTH('192.168.1.1/17') IS NULL OR NETLENGTH('192.168.1.1/17')!=32768;
select 'ERROR NETLENGTH(''192.168.1.0/28'')' where NETLENGTH('192.168.1.0/28') IS NULL OR NETLENGTH('192.168.1.0/28')!=16;
select 'ERROR NETLENGTH(''a192.168.1.0/28'')' where NETLENGTH('a192.168.1.0/28') IS NOT NULL;
select 'ERROR NETLENGTH(''192.168.1.0/28a'')' where NETLENGTH('192.168.1.0/28a') IS NOT NULL;

select 'ERROR NETMASKLENGTH(''24'')' where NETMASKLENGTH('24') IS NOT NULL;
select 'ERROR NETMASKLENGTH(24)' where NETMASKLENGTH(24) IS NULL OR NETMASKLENGTH(24)!=256;
select 'ERROR NETMASKLENGTH(''32'')' where NETMASKLENGTH('32') IS NOT NULL;
select 'ERROR NETMASKLENGTH(32)' where NETMASKLENGTH(32) IS NULL OR NETMASKLENGTH(32)!=1;
select 'ERROR NETMASKLENGTH(''17'')' where NETMASKLENGTH('17') IS NOT NULL;
select 'ERROR NETMASKLENGTH(17)' where NETMASKLENGTH(17) IS NULL OR NETMASKLENGTH(17)!=32768;
select 'ERROR NETMASKLENGTH(''/255.255.255.0'')' where NETMASKLENGTH('/255.255.255.0') IS NULL OR NETMASKLENGTH('/255.255.255.0')!=256;
select 'ERROR NETMASKLENGTH(''a/255.255.255.0'')' where NETMASKLENGTH('a/255.255.255.0') IS NOT NULL;
select 'ERROR NETMASKLENGTH(''/255.255.255.0a'')' where NETMASKLENGTH('/255.255.255.0a') IS NOT NULL;
select 'ERROR NETMASKLENGTH(''a192.168.1.1/255.255.255.0'')' where NETMASKLENGTH('a192.168.1.1/255.255.255.0') IS NOT NULL;
select 'ERROR NETMASKLENGTH(''192.168.1.1/255.255.255.0'')' where NETMASKLENGTH('192.168.1.1/255.255.255.0') IS NULL OR NETMASKLENGTH('192.168.1.1/255.255.255.0')!=256;

select 'ERROR NETTO(''192.168.1.1/24'') - NETFROM(''192.168.1.1/24'')' where NETTO('192.168.1.1/24') IS NULL OR  NETFROM('192.168.1.1/24') IS NULL OR NETTO('192.168.1.1/24') - NETFROM('192.168.1.1/24')!=255;
select 'ERROR NETTO(''192.168.1.1/255.255.255.0'') - NETFROM(''192.168.1.1/255.255.255.0'')' where NETTO('192.168.1.1/255.255.255.0') IS NULL OR NETFROM('192.168.1.1/255.255.255.0') IS NULL OR NETTO('192.168.1.1/255.255.255.0') - NETFROM('192.168.1.1/255.255.255.0')!=255;
select 'ERROR NETTO(''192.168.1.1'',''255.255.255.0'') - NETFROM(''192.168.1.1'',''255.255.255.0'')' where NETTO('192.168.1.1','255.255.255.0') IS NULL OR NETFROM('192.168.1.1','255.255.255.0') IS NULL OR NETTO('192.168.1.1','255.255.255.0') - NETFROM('192.168.1.1','255.255.255.0')!=255;
select 'ERROR NETTO(''192.168.1.1'',''24'') - NETFROM(''192.168.1.1'',''24'')' where NETTO('192.168.1.1','24') IS NOT NULL OR NETFROM('192.168.1.1','24') IS NOT NULL;

select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/24'')' where ISINNET( '172.16.1.193', '172.16.1.0/24' ) IS NULL OR ISINNET( '172.16.1.193', '172.16.1.0/24' )!=1;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0a/33'')' where ISINNET('172.16.1.193','172.16.1.0a/33') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/33'')' where ISINNET('172.16.1.193','172.16.1.0/33') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/a'')' where ISINNET('172.16.1.193','172.16.1.0/a') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/0'')' where ISINNET('172.16.1.193','172.16.1.0/0') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/1a'')' where ISINNET('172.16.1.193','172.16.1.0/1a') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/10a'')' where ISINNET('172.16.1.193','172.16.1.0/10a') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/a1'')' where ISINNET('172.16.1.193','172.16.1.0/a1') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/a10'')' where ISINNET('172.16.1.193','172.16.1.0/a10') IS NOT NULL;

select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',''255.255.255.0'')' where ISINNET('172.16.1.193','172.16.1.0','255.255.255.0') IS NULL OR ISINNET('172.16.1.193','172.16.1.0','255.255.255.0')!=1;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/255.255.255.0'')' where ISINNET('172.16.1.193','172.16.1.0/255.255.255.0') IS NULL OR ISINNET('172.16.1.193','172.16.1.0/255.255.255.0')!=1;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',''255.255.255.128'')' where ISINNET('172.16.1.193','172.16.1.0','255.255.255.128') IS NULL OR ISINNET('172.16.1.193','172.16.1.0','255.255.255.128')!=0;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/255.255.255.128'')' where ISINNET('172.16.1.193','172.16.1.0/255.255.255.128') IS NULL OR ISINNET('172.16.1.193','172.16.1.0/255.255.255.128')!=0;
select 'ERROR ISINNET(''172.16.1.193'',''a172.16.1.0/255.255.255.128'')' where ISINNET('172.16.1.193','a172.16.1.0/255.255.255.128') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0a/255.255.255.128'')' where ISINNET('172.16.1.193','172.16.1.0a/255.255.255.128') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/a255.255.255.128'')' where ISINNET('172.16.1.193','172.16.1.0/a255.255.255.128') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/255.255.255.128a'')' where ISINNET('172.16.1.193','172.16.1.0/255.255.255.128a') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/aaa'')' where ISINNET('172.16.1.193','172.16.1.0/aaa') IS NOT NULL;

select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',24)' where ISINNET('172.16.1.193','172.16.1.0',24) IS NULL OR ISINNET('172.16.1.193','172.16.1.0',24)!=1;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',25)' where ISINNET('172.16.1.193','172.16.1.0',25) IS NULL OR ISINNET('172.16.1.193','172.16.1.0',25)!=0;
select 'ERROR ISINNET(''172.16.1.193'',''a172.16.1.0'',25)' where ISINNET('172.16.1.193','a172.16.1.0',25) IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0a'',25)' where ISINNET('172.16.1.193','172.16.1.0a',25) IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',''25'')' where ISINNET('172.16.1.193','172.16.1.0','25') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',''25a'')' where ISINNET('172.16.1.193','172.16.1.0','25a') IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',-1)' where ISINNET('172.16.1.193','172.16.1.0',-1) IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',33)' where ISINNET('172.16.1.193','172.16.1.0',33) IS NOT NULL;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0/25'')' where ISINNET('172.16.1.193','172.16.1.0/25') IS NULL OR ISINNET('172.16.1.193','172.16.1.0/25')!=0;
select 'ERROR ISINNET(''172.16.1.193'',''172.16.1.0'',0)' where ISINNET('172.16.1.193','172.16.1.0',0) IS NOT NULL;

select 'ERROR ISSAMENET(''172.16.1.193'',''172.16.1.0'',0)' where ISSAMENET('172.16.1.193','172.16.1.0',0) IS NOT NULL;
select 'ERROR ISSAMENET(''172.16.1.193'',''172.16.1.0'',32)' where ISSAMENET('172.16.1.193','172.16.1.0',32) IS NULL OR ISSAMENET('172.16.1.193','172.16.1.0',32)!=0;
select 'ERROR ISSAMENET(''172.16.1.193'',''172.16.1.0'',24)' where ISSAMENET('172.16.1.193','172.16.1.0',24) IS NULL OR ISSAMENET('172.16.1.193','172.16.1.0',24)!=1;
select 'ERROR ISSAMENET(''172.16.1.193'',''172.16.1.0'',''255.255.255.0'')' where ISSAMENET('172.16.1.193','172.16.1.0','255.255.255.0') IS NULL OR ISSAMENET('172.16.1.193','172.16.1.0','255.255.255.0')!=1;

CREATE TEMP TABLE ip_add (ip);
INSERT INTO ip_add VALUES('172.16.1.40');
INSERT INTO ip_add VALUES('172.16.1.93');
INSERT INTO ip_add VALUES('172.16.1.204');
INSERT INTO ip_add VALUES('172.16.4.203');
INSERT INTO ip_add VALUES('172.16.4.205');
INSERT INTO ip_add VALUES('172.16.4.69');
INSERT INTO ip_add VALUES('10.0.1.204');
INSERT INTO ip_add VALUES('10.0.1.16');
INSERT INTO ip_add VALUES('10.1.0.16');
INSERT INTO ip_add VALUES('192.168.1.5');
INSERT INTO ip_add VALUES('192.168.1.7');
INSERT INTO ip_add VALUES('192.168.1.19');

select 'ERROR' where (SELECT group_concat(ip) FROM ip_add WHERE ISINNET( ip, '172.16.1.0', 16 ))!='172.16.1.40,172.16.1.93,172.16.1.204,172.16.4.203,172.16.4.205,172.16.4.69';
select 'ERROR' where (SELECT group_concat(ip) FROM ip_add WHERE ISINNET( ip, '172.16.1.0/16' ))!='172.16.1.40,172.16.1.93,172.16.1.204,172.16.4.203,172.16.4.205,172.16.4.69';

select 'ERROR' where (SELECT group_concat(ip) FROM ip_add WHERE ISINNET( ip, '172.16.1.0', 24 ))!='172.16.1.40,172.16.1.93,172.16.1.204';
select 'ERROR' where (SELECT group_concat(ip) FROM ip_add WHERE ISINNET( ip, '172.16.1.0/24' ))!='172.16.1.40,172.16.1.93,172.16.1.204';

select 'ERROR' where (SELECT group_concat(ip) FROM ip_add WHERE NOT ISINNET( ip, '128.0.0.0', 1 ))!='10.0.1.204,10.0.1.16,10.1.0.16';
select 'ERROR' where (SELECT group_concat(ip) FROM ip_add WHERE NOT ISINNET( ip, '128.0.0.0/1' ))!='10.0.1.204,10.0.1.16,10.1.0.16';

DELETE FROM ip_add WHERE NOT ISINNET( ip, '128.0.0.0', 1 );
DELETE FROM ip_add WHERE NOT ISINNET( ip, '128.0.0.0/1' );

select 'ERROR' where (SELECT group_concat(ip) FROM ip_add)!=
    '172.16.1.40,172.16.1.93,172.16.1.204,172.16.4.203,172.16.4.205,172.16.4.69,192.168.1.5,192.168.1.7,192.168.1.19';

DROP TABLE ip_add;
